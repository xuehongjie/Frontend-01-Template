<script>
  function find(source, pattern) {
    let table = new Array(pattern.length).fill(0);
    let k = 0;

    for (let j = 1; j < pattern.length; j++) {
      console.log(pattern[j], pattern[k]);
      if (pattern[j] === pattern[k]) {
        k++;
      } else {
        k = 0;
      }
      table[j] = 0;
    }

    let j = 0;
    for (let i = 0; i < source.length; i++) {
      // console.log(source[i], pattern[j]);
      if (source[i] === pattern[j]) {
        j++;
      } else {
        j = table[j - 1];
        if (source[i] === pattern[j]) {
          j++;
        } else {
          // 处理ababab这种重复的
          /* while (source[i] !== pattern[j] && j > 0) {
            j = table[j - 1];
          }
          if (source[i] === pattern[j]) {
            j++;
          } else {
            j = 0;
          } */
          j = 0;
        }
      }
      if (j === pattern.length) {
        return true;
      }
    }
    return false;
  }
</script>
